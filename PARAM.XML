<commandList name="FLexible Exasclae Kinetic Simulator: PC component">

<command name="SAVEPLOT">

The description for this comand is not accurate. 

#SAVEPLOT
4                       nPlotFile
sat_sat01.sat  var ascii si        StringPlot
-1                      DnOutput
3.0                     DtOutput
0.                      DxOutput
rhoS0 rhoS1 rho pxx pxxS0 pxxS1 Ex Ey Ez Bx By Bz
sat_sat02.sat particles1 real4 si   StringPlot
1                       DnOutput
-0.05                   DtOutput
10.          		DxOutput (save every DxOutput particles)
z=0 var ascii si        StringPlot
-1                      DnOutput
3.0                     DtOutput
0.                      DxOutput
rhoS0 rhoS1 rho pxx pxxS0 pxxS1 Ex Ey Ez Bx By Bz
x=0 var ascii pic       StringPlot
1                       DnOutput
-0.05                   DtOutput
0.                      DxOutput
rhoS0 rhoS1 bx by pxx   NamePlotVar
3d all real4  planet    StringPlot
1                       DnOutput
-0.05                   DtOutput
5                       DxOutput
cut all real8 si        StringPlot
1                       DnOutput
-0.05                   DtOutput
0                       xMin
1                       xMax
2                       yMin
3                       yMax
4                       zMin
5                       zMax
0.                      DxOutput
cut particles0 real4 si
1                       DnOutput
-0.05                   DtOutput
0                       xMin
1                       xMax
2                       yMin
3                       yMax
4                       zMin
5                       zMax
1.            		DxOutput (save every DxOutput particles)
3d particles1 real4 si   StringPlot
1                       DnOutput
-0.05                   DtOutput
10.          		DxOutput (save every DxOutput particles)

This command determines the IDL type output from FLEKS.

The first parameter is nPlotFile, which is the number of files to be saved.
Each output starts with StringPlot, which specify the output region, variables,
file format and variable units. The plotting frequencies DnOutput and DtOutput
are following. DnOutput is needed and it only works for particles and '3d' type
field output. Only one of every DnOutput nodes/particles are saved in order
to save disk space, also to speed out the post processing and virtualization.
Several other parameters may follow based on the content of StringPlot.

StringPlot has the format:'domain variables format unit'.
'domain' can be one of the following:
\begin{verbatim}
x=x0     - a 2D cut of x=x0 plane. 'x0' is the coordinate.
y=y0     - a 2D cut of y=y0 plane. 'y0' is the coordinate.
z=z0     - a 2D cut of z=z0 plane. 'z0' is the coordinate.
3d       - the whole computational domain.
1d       - the whole computational domain. It is essentially the same as '3d'.
cut      - part of the 3D domain. Need to specifiy the output range.
sat_SatelliteFile  - save information along the satellite trajectory read from SatelliteFile.
\end{verbatim}
The value of 'variables' could be:
\begin{verbatim}
all                                 - all the PIC field variables of the first two species:
   'qS0 qS1 Bx By Bz Ex Ey Ez kXXS0 kYYS0 kZZS0 kXYS0 kXZS0 kYZS0 kXXS1 kYYS1 kZZS1 kXYS1 kXZS1 kYZS1 jxS0 jyS0 jzS0 jxS1 jyS1 jzS1'
fluid                               - all the FLUID field variables of the first two species:
   'rhoS0 rhoS1 Bx By Bz Ex Ey Ez uxS0 uyS0 uzS0 uxS1 uyS1 uzS1 pS0 pS1 pXXS0 pYYS0 pZZS0 pXYS0 pXZS0 pYZS0 pXXS1 pYYS1 pZZS1 pXYS1 pXZS1 pYZS1'
var                                 - read from parameter file
particles0/particles1/particles2... - the location, velocity and weight of particles belonging to species0, species1, ... 
   The particle species needs to be specified. One and only one species is allowd in one output file. 
\end{verbatim}

qS0 and qS1 are charge densities, while rhos0 and rhos1 are mass densities.
kXXS0 = sum(vx*vx), where vx is the particle velocity. So kXXS0 includes the
effect of bulk velocity. But pXXS0 is true pressure that excludes
the influence of the bulk velocity.

The file format could be either 'real4' or 'ascii'. The 'unit' can be:
\begin{verbatim}
PIC  - normalized PIC unit.
SI   - SI unit. The unit of current and electric field are not well defined. 
PLANETARY - planetary unit. B field is in nT, velocity is in km/s, length is in planet radius, density is in amu/cm^3, pressure is in nPa. Current and electric field are not well defined. 
\end{verbatim}

Note:
1) Available output variables are listed in EMfields3D.cpp::getVar().
2) DxOutput is only functional for particles and 3d field output now.
3) The position for "cut", "x=", "y="... is in BATSRUS coordinate.
4) Output variable 'particles' only works for 'cut', '3d' and 'sat'.
5) The unit of current and electric field are not well defined so far.

There is no plot file saved by default.
</command>

<command name="PERIODICITY">
  <parameter name="isPeriodicX" type="logical" default="F" />
  <parameter name="isPeriodicY" type="logical" default="F" />
  <parameter name="isPeriodicZ" type="logical" default="F" />
  
#PERIODICITY
F                 isPeriodicX
F                 isPeriodicY
F                 isPeriodicZ

We may want to use periodic boundary conditions in some directions even in
a coupled simulation, and the command above can be used. Note that if there
is only one cell in one direction, periodic boundary conditions will be used
in this direction and the parameter above will be ignored. Otherwise
the default value is false.
</command>

<command name="EFIELDSOLVER">
  <parameter name="EFieldTol"  type="real"    default="1e-6"/>
  <parameter name="EFieldIter" type="integer" default="200"/>
  
#EFIELDSOLVER
1e-6                     EFieldTol
200                      EFieldIter

The tolerance and the maximum iteration number of the electric field 
GMRES solver. The default values are shown above. 
</command>

<command name="DISCRETIZATION">
  <parameter name="theta" type="real" default="0.51"/>
  <parameter name="ratioDivC2C" type="real" default="0.1" />

#DISCRETIZATION
0.51                        theta
0.1                         ratioDivC2C

The electric field is calculated at the time $t_{n+\theta}$. When $\theta$ 
is 0.5, the total energy is conserved if ratioDivC2C is 0. However, 
the exact energy conservation may produce artifical oscillations. 
0.51-0.6 are typical values of $\theta$.

'ratioDivC2C' is the ratio of div(E) calculated from extended stencil
discretization. It helps to suppress short-wavelength oscillations. 
Default values are shown.
</command>

<command name="DIVE">
  <parameter name="doCorrectDivE" type="logical" default="T"/>
  
#DIVE
T                         doCorrectDivE

Turning on/off the accurate div(E) cleaning, which corrects the particle
locations to satisfy Gauss's law: div(E) = net_charge. 
Default is true as it is required for accuracy of long simulations.
</command>

<command name="TIMESTEPPING" required="T">
  <parameter name="dt" type="real"/>

#TIMESTEPPING
0.1                dt

So far, only fixed time step is supported. There is no default value,
so this command is required.
</command>

<command name="ELECTRON">
  <parameter name="ElectronChargePerMass" type="real" default='-100'>

#ELECTRON
-100                     ElectronChargePerMass

This command sets the charge per mass in normalized unit for electrons.
It is ignored when FLEKS is coupled with BATSRUS configured with the 
five-moment or six-moment fluid closures that define the electron mass.

Default value is shown.
</command>

</commandList>
